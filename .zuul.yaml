---
- secret:
    name: SECRET_ANSIBLE_COLLECTION_SERVICES
    data:
      DTRACK_API_KEY: !encrypted/pkcs1-oaep
        - MbeDjK97OYNuH3+cAD/C0JRH4Qoxo0Otal+J0zGNd11Qetrt5dtN5rcHVotdlRbQ42VSj
          kNtPb/kMoR1Bq/RfLZXUfD+zGdBdWXtslSIahoUmMGkvWDWdmN7ZlPB0rNdkZNV/Y/ePP
          sAIqFLDEyQRuaKIl3f6k7PHVBEbX6vv/F+rzjwToKCSslMzDzlWdrZ69JXCJ2+8o2k/I6
          a5Hl943fEf0xNP9XM1KhXJKnSTSvf+ccCqadk+0UpaAIoo0yRR3MO6oqN/6ALe7k3C5nw
          XpeexvIUVaUQRW5YOKujUuLtlai59gaC8j/j5+D+oh4CV7qc9BJI+i3TCo4lfVjyyj+CT
          KryNgirLOoQj9nuhBcjsh4+CRvi627zom/GKdMobqwtKsVAREl8stMnsF8hMOzs3ru624
          ZkoJAtUppvgzUnQrWMKYzYXBLF1oqQXfQiHnO8mSvYPXq2QOBAdQ6vHD0D30ZX+3MsFI1
          SP6DNG+96aKvrz8p3KXWSDcD+O2/29kEGnzJJx61WsIdhtMAQQmvbMhzXGEFdz91QCE63
          yI7OCmlEzgYkUnPCH8+OLFzsyv7u+Tz0AEiWtk2/le1HPJ8wwYtjPj8rwXVnVWSzeVaRw
          hC2CrJ+7z6cTTleEebjPUN0DXkNsXda6ESuV1Yz+zj9sSxA2JZfHMAlJkIDM0o=
      DOCKER_USERNAME: !encrypted/pkcs1-oaep
        - iJh+13BSzDawvbTpOR3/UtYa15d0U+IWBeEDFSym+vdHS1f6AvVPmNVAhSdKO4PHc4YVz
          aIxmP2vKc2bL0uaHQU/LrL/hiiJNJS4bL8sRk1qwbvsgzry+Au/ZMfrFw0v7Xas4OOn9f
          ERLA8ya25lIuqKMCCBu6DueXIzZ6USHcBUd/8RARWgZScEetzAaTSkJuO4uTTGxWLfK46
          P59LbIcRi7XqrfVnqK4EWWB9aNDtt8/SZvzogKcWfAEPleAibX1iriBB6w9BeNjfjwLVW
          nJePThEMJeQTfGDEf6a1XOFjWSYJf9zP6XGfZUbJOJId7ak+nMVMpYfWERhO/kiKM8KNQ
          yts6WDF6W59M4bbI3JM4mjjjMYiuZTl/0UhfYbRbPhLgm0DjiBZrLMvmnKqryklmEJOdX
          AmlKd9mDhgI+hIfIPuX3N1Nj+g0w87WttW0Bmptahi2D0t2JulGbYP/OlBuV3GwRZfDfV
          60Nr+Mq3LlDffra8vgQi7YF9uvwvDuQwj4MQP53gyapzZJSyFL85Ae2mP9CSPe93i6EGC
          Yn8QAv6YmnV00XmA0f2Oo2K048Y36zHgfeCLvGXJRNO0ixt1eqU9FcJfyqK/U7AikzqXV
          bXqwIiDCi0wrp4kRjxzHFfKPLjRWhk3HiW3iOxmMp+E2iZhUoHWod5ehvcw73Y=
      DOCKER_PASSWORD: !encrypted/pkcs1-oaep
        - bAWiLRQWVVblqVuTbGIqBQlCRfVJxdtBkR08WqXDo7+5xJZd8ad7NLHFUskPMuxveThuu
          DqdY8zOGLXxG9+rlGjULjBWyTiSi/d5ATFQuBHfgEBPBfhw3uL5yp+/bKESxtcvNMucP0
          xIkbKGdEkfVuCXmxAFhqaLD7i8/jXvfxnE5GwTD/HygPI5D7wpiOi72Ykr2mtZJfT5IXm
          O71tOlTtSXgAWR+8Lms6d6o9KKFRub7lLH2fJ81xJjqLxhE8ue54/Anf5FBl6no9pXUT/
          motgDM4/B4IOunXc0IhXD2y3em9GI4vdXDkfRJ17NI0Xo8oq+qCGQepdkluUs8saIA2U6
          +jO0L19IJMyiJX+0crs3S4iy+zPjPlXL/v1H99nc9hPiAGWpWkJfHgAmkqacDS8qt1Qes
          QU+kvLRho/qp6aK1WCe034HPm+ppDMPxwWNY7BSas8rVP/JdurBn+JhOgQ2alifO+y0oc
          fkW84E4PyltJb23kjoikO+l1T/y27Ynquq9fBjc8FWUcnQtV1PQIUJcBqdDZ0VSJEUMkQ
          2mJ+MW0g6OOeSqcAFJmZ6KefGqdngD03KISFn8kIvgNJxcZiEsSwqxRuK8PNZvYxJyHzJ
          3maJQdOQcaXGX8Y2kBCuMBZQCNmb0pb1WGz6y5BzwCOfUzQH3K1q6ss1x4jr/s=

- job:
    name: ansible-collection-services-container-image-osism-ansible-push
    parent: abstract-container-image-osism-ansible-push
    secrets:
      - name: secret
        secret: SECRET_ANSIBLE_COLLECTION_SERVICES
        pass-to-parent: true

- job:
    name: abstract-ansible-collection-services-molecule
    parent: ansible-molecule
    abstract: true
    nodeset:
      nodes:
        - name: centos-9-stream
          label: centos-9-stream
        - name: debian-bookworm
          label: debian-bookworm
        - name: ubuntu-jammy
          label: ubuntu-jammy
        - name: ubuntu-noble
          label: ubuntu-noble
    vars:
      ansible_molecule_ansible_version: "11.4.0"
    files:
      - '^\.zuul\.yaml$'
      - '^molecule\/requirements\.txt$'
      - '^molecule\/delegated\/[^\/]*yml$'

- job:
    name: ansible-collection-services-molecule-adminer
    parent: abstract-ansible-collection-services-molecule
    vars:
      ansible_role: adminer
    files:
      - '^roles\/adminer\/.*$'
      - '^molecule\/delegated\/tests\/adminer.*$'

- job:
    name: ansible-collection-services-molecule-auditd
    parent: abstract-ansible-collection-services-molecule
    vars:
      ansible_role: auditd
    files:
      - '^roles\/auditd\/.*$'
      - '^molecule\/delegated\/tests\/auditd.*$'

- job:
    name: ansible-collection-services-molecule-cephclient
    parent: abstract-ansible-collection-services-molecule
    vars:
      ansible_role: cephclient
    files:
      - '^roles\/cephclient\/.*$'
      - '^molecule\/delegated\/tests\/cephclient.*$'

- job:
    name: ansible-collection-services-molecule-cgit
    parent: abstract-ansible-collection-services-molecule
    vars:
      ansible_role: cgit
    files:
      - '^roles\/cgit\/.*$'
      - '^molecule\/delegated\/tests\/cgit.*$'

- job:
    name: ansible-collection-services-molecule-chrony
    parent: abstract-ansible-collection-services-molecule
    vars:
      ansible_role: chrony
    files:
      - '^roles\/chrony\/.*$'
      - '^molecule\/delegated\/tests\/chrony.*$'

- job:
    name: ansible-collection-services-molecule-clamav
    parent: abstract-ansible-collection-services-molecule
    vars:
      ansible_role: clamav
    files:
      - '^roles\/clamav\/.*$'
      - '^molecule\/delegated\/tests\/clamav.*$'

- job:
    name: ansible-collection-services-molecule-containerd
    parent: abstract-ansible-collection-services-molecule
    vars:
      ansible_role: containerd
    files:
      - '^roles\/containerd\/.*$'
      - '^molecule\/delegated\/tests\/containerd.*$'

- job:
    name: ansible-collection-services-molecule-dnsdist
    parent: abstract-ansible-collection-services-molecule
    vars:
      ansible_role: dnsdist
    files:
      - '^roles\/dnsdist\/.*$'
      - '^molecule\/delegated\/tests\/dnsdist.*$'

- job:
    name: ansible-collection-services-molecule-dnsmasq
    parent: abstract-ansible-collection-services-molecule
    vars:
      ansible_role: dnsmasq
    files:
      - '^roles\/dnsmasq\/.*$'
      - '^molecule\/delegated\/tests\/dnsmasq.*$'

- job:
    name: ansible-collection-services-molecule-docker
    parent: abstract-ansible-collection-services-molecule
    vars:
      ansible_role: docker
    files:
      - '^roles\/docker\/.*$'
      - '^molecule\/delegated\/tests\/docker.*$'

- job:
    name: ansible-collection-services-molecule-fail2ban
    parent: abstract-ansible-collection-services-molecule
    vars:
      ansible_role: fail2ban
    files:
      - '^roles\/fail2ban\/.*$'
      - '^molecule\/delegated\/tests\/fail2ban.*$'

- job:
    name: ansible-collection-services-molecule-falco
    parent: abstract-ansible-collection-services-molecule
    vars:
      ansible_role: falco
    files:
      - '^roles\/falco\/.*$'
      - '^molecule\/delegated\/tests\/falco.*$'

- job:
    name: ansible-collection-services-molecule-frr
    parent: abstract-ansible-collection-services-molecule
    vars:
      ansible_role: frr
    files:
      - '^roles\/frr\/.*$'
      - '^molecule\/delegated\/tests\/frr.*$'

- job:
    name: ansible-collection-services-molecule-hddtemp
    parent: abstract-ansible-collection-services-molecule
    vars:
      ansible_role: hddtemp
    files:
      - '^roles\/hddtemp\/.*$'
      - '^molecule\/delegated\/tests\/hddtemp.*$'

- job:
    name: ansible-collection-services-molecule-homer
    parent: abstract-ansible-collection-services-molecule
    vars:
      ansible_role: homer
    files:
      - '^roles\/homer\/.*$'
      - '^molecule\/delegated\/tests\/homer.*$'

- job:
    name: ansible-collection-services-molecule-httpd
    parent: abstract-ansible-collection-services-molecule
    vars:
      ansible_role: httpd
    files:
      - '^roles\/httpd\/.*$'
      - '^molecule\/delegated\/tests\/httpd.*$'

- job:
    name: ansible-collection-services-molecule-journald
    parent: abstract-ansible-collection-services-molecule
    vars:
      ansible_role: journald
    files:
      - '^roles\/journald\/.*$'
      - '^molecule\/delegated\/tests\/journald.*$'

- job:
    name: ansible-collection-services-molecule-lldpd
    parent: abstract-ansible-collection-services-molecule
    vars:
      ansible_role: lldpd
    files:
      - '^roles\/lldpd\/.*$'
      - '^molecule\/delegated\/tests\/lldpd.*$'

- job:
    name: ansible-collection-services-molecule-manager
    parent: abstract-ansible-collection-services-molecule
    vars:
      ansible_role: manager
    files:
      - '^roles\/manager\/.*$'
      - '^molecule\/delegated\/prepare\/manager.*$'
      - '^molecule\/delegated\/tests\/manager.*$'
      - '^molecule\/delegated\/vars\/manager.*$'

- job:
    name: ansible-collection-services-molecule-netbox
    parent: abstract-ansible-collection-services-molecule
    vars:
      ansible_role: netbox
    files:
      - '^roles\/netbox\/.*$'
      - '^molecule\/delegated\/tests\/netbox.*$'

- job:
    name: ansible-collection-services-molecule-netbird
    parent: abstract-ansible-collection-services-molecule
    vars:
      ansible_role: netbird
    files:
      - '^roles\/netbird\/.*$'
      - '^molecule\/delegated\/tests\/netbird.*$'

- job:
    name: ansible-collection-services-molecule-netdata
    parent: abstract-ansible-collection-services-molecule
    vars:
      ansible_role: netdata
    files:
      - '^roles\/netdata\/.*$'
      - '^molecule\/delegated\/tests\/netdata.*$'

- job:
    name: ansible-collection-services-molecule-nexus
    parent: abstract-ansible-collection-services-molecule
    vars:
      ansible_role: nexus
    files:
      - '^roles\/nexus\/.*$'
      - '^molecule\/delegated\/tests\/nexus.*$'

- job:
    name: ansible-collection-services-molecule-openstackclient
    parent: abstract-ansible-collection-services-molecule
    vars:
      ansible_role: openstackclient
    files:
      - '^roles\/openstackclient\/.*$'
      - '^molecule\/delegated\/tests\/openstackclient.*$'

- job:
    name: ansible-collection-services-molecule-osquery
    parent: abstract-ansible-collection-services-molecule
    vars:
      ansible_role: osquery
    files:
      - '^roles\/osquery\/.*$'
      - '^molecule\/delegated\/tests\/osquery.*$'

- job:
    name: ansible-collection-services-molecule-phpmyadmin
    parent: abstract-ansible-collection-services-molecule
    vars:
      ansible_role: phpmyadmin
    files:
      - '^roles\/phpmyadmin\/.*$'
      - '^molecule\/delegated\/tests\/phpmyadmin.*$'

- job:
    name: ansible-collection-services-molecule-rng
    parent: abstract-ansible-collection-services-molecule
    vars:
      ansible_role: rng
    files:
      - '^roles\/rng\/.*$'
      - '^molecule\/delegated\/tests\/rng.*$'

- job:
    name: ansible-collection-services-molecule-rsyslog
    parent: abstract-ansible-collection-services-molecule
    vars:
      ansible_role: rsyslog
    files:
      - '^roles\/rsyslog\/.*$'
      - '^molecule\/delegated\/tests\/rsyslog.*$'

- job:
    name: ansible-collection-services-molecule-scaphandre
    parent: abstract-ansible-collection-services-molecule
    vars:
      ansible_role: scaphandre
    files:
      - '^roles\/scaphandre\/.*$'
      - '^molecule\/delegated\/tests\/scaphandre.*$'

- job:
    name: ansible-collection-services-molecule-smartd
    parent: abstract-ansible-collection-services-molecule
    vars:
      ansible_role: smartd
    files:
      - '^roles\/smartd\/.*$'
      - '^molecule\/delegated\/tests\/smartd.*$'

- job:
    name: ansible-collection-services-molecule-sshd
    parent: abstract-ansible-collection-services-molecule
    vars:
      ansible_role: sshd
    files:
      - '^roles\/sshd\/.*$'
      - '^molecule\/delegated\/tests\/sshd.*$'

- job:
    name: ansible-collection-services-molecule-squid
    parent: abstract-ansible-collection-services-molecule
    vars:
      ansible_role: squid
    files:
      - '^roles\/squid\/.*$'
      - '^molecule\/delegated\/tests\/squid.*$'

- job:
    name: ansible-collection-services-molecule-thanos_sidecar
    parent: abstract-ansible-collection-services-molecule
    vars:
      ansible_role: thanos_sidecar
    files:
      - '^roles\/thanos_sidecar\/.*$'
      - '^molecule\/delegated\/tests\/thanos_sidecar.*$'

- job:
    name: ansible-collection-services-molecule-teleport
    parent: abstract-ansible-collection-services-molecule
    vars:
      ansible_role: teleport
    files:
      - '^roles\/teleport\/.*$'
      - '^molecule\/delegated\/tests\/teleport.*$'

- job:
    name: ansible-collection-services-molecule-traefik
    parent: abstract-ansible-collection-services-molecule
    vars:
      ansible_role: traefik
    files:
      - '^roles\/traefik\/.*$'
      - '^molecule\/delegated\/tests\/traefik.*$'

- job:
    name: ansible-collection-services-molecule-tuned
    parent: abstract-ansible-collection-services-molecule
    vars:
      ansible_role: tuned
    files:
      - '^roles\/tuned\/.*$'
      - '^molecule\/delegated\/tests\/tuned.*$'

- job:
    name: ansible-collection-services-molecule-wazuh-agent
    parent: abstract-ansible-collection-services-molecule
    vars:
      ansible_role: wazuh_agent
    files:
      - '^roles\/wazuh-agent\/.*$'
      - '^molecule\/delegated\/tests\/wazuh-agent.*$'

- job:
    name: ansible-collection-services-molecule-wireguard
    parent: abstract-ansible-collection-services-molecule
    vars:
      ansible_role: wireguard
    files:
      - '^roles\/wireguard\/.*$'
      - '^molecule\/delegated\/tests\/wireguard.*$'

- job:
    name: ansible-collection-services-molecule-zabbix_agent
    parent: abstract-ansible-collection-services-molecule
    vars:
      ansible_role: zabbix_agent
    files:
      - '^roles\/zabbix_agent\/.*$'
      - '^molecule\/delegated\/prepare\/zabbix_agent.*$'
      - '^molecule\/delegated\/tests\/zabbix_agent.*$'
      - '^molecule\/delegated\/vars\/zabbix_agent.*$'

- job:
    name: ansible-collection-services-molecule-zuul
    parent: abstract-ansible-collection-services-molecule
    vars:
      ansible_role: zuul
    files:
      - '^roles\/zuul\/.*$'
      - '^molecule\/delegated\/tests\/zuul.*$'

- project:
    merge-mode: squash-merge
    default-branch: main
    check:
      jobs:
        - ansible-collection-services-molecule-adminer
        - ansible-collection-services-molecule-auditd
        - ansible-collection-services-molecule-cephclient
        - ansible-collection-services-molecule-cgit
        - ansible-collection-services-molecule-chrony
        - ansible-collection-services-molecule-clamav
        - ansible-collection-services-molecule-containerd
        - ansible-collection-services-molecule-dnsdist
        - ansible-collection-services-molecule-dnsmasq
        - ansible-collection-services-molecule-docker
        - ansible-collection-services-molecule-fail2ban
        - ansible-collection-services-molecule-falco
        - ansible-collection-services-molecule-frr
        - ansible-collection-services-molecule-hddtemp
        - ansible-collection-services-molecule-homer
        - ansible-collection-services-molecule-httpd
        - ansible-collection-services-molecule-journald
        - ansible-collection-services-molecule-lldpd
        - ansible-collection-services-molecule-manager
        - ansible-collection-services-molecule-netbox
        - ansible-collection-services-molecule-netbird
        - ansible-collection-services-molecule-netdata
        - ansible-collection-services-molecule-nexus
        - ansible-collection-services-molecule-openstackclient
        - ansible-collection-services-molecule-osquery
        - ansible-collection-services-molecule-phpmyadmin
        - ansible-collection-services-molecule-rng
        - ansible-collection-services-molecule-rsyslog
        - ansible-collection-services-molecule-scaphandre
        - ansible-collection-services-molecule-smartd
        - ansible-collection-services-molecule-sshd
        - ansible-collection-services-molecule-squid
        - ansible-collection-services-molecule-thanos_sidecar
        - ansible-collection-services-molecule-teleport
        - ansible-collection-services-molecule-traefik
        - ansible-collection-services-molecule-tuned
        - ansible-collection-services-molecule-wazuh-agent
        - ansible-collection-services-molecule-wireguard
        - ansible-collection-services-molecule-zabbix_agent
        - ansible-collection-ensure-readme
        - ansible-lint
        - flake8
        - python-black
        - yamllint
    gate:
      jobs:
        - ansible-collection-services-molecule-adminer
        - ansible-collection-services-molecule-auditd
        - ansible-collection-services-molecule-cephclient
        - ansible-collection-services-molecule-cgit
        - ansible-collection-services-molecule-chrony
        - ansible-collection-services-molecule-clamav
        - ansible-collection-services-molecule-containerd
        - ansible-collection-services-molecule-dnsdist
        - ansible-collection-services-molecule-dnsmasq
        - ansible-collection-services-molecule-docker
        - ansible-collection-services-molecule-fail2ban
        - ansible-collection-services-molecule-falco
        - ansible-collection-services-molecule-frr
        - ansible-collection-services-molecule-hddtemp
        - ansible-collection-services-molecule-homer
        - ansible-collection-services-molecule-httpd
        - ansible-collection-services-molecule-journald
        - ansible-collection-services-molecule-lldpd
        - ansible-collection-services-molecule-manager
        - ansible-collection-services-molecule-netbox
        - ansible-collection-services-molecule-netbird
        - ansible-collection-services-molecule-netdata
        - ansible-collection-services-molecule-nexus
        - ansible-collection-services-molecule-openstackclient
        - ansible-collection-services-molecule-osquery
        - ansible-collection-services-molecule-phpmyadmin
        - ansible-collection-services-molecule-rng
        - ansible-collection-services-molecule-rsyslog
        - ansible-collection-services-molecule-scaphandre
        - ansible-collection-services-molecule-smartd
        - ansible-collection-services-molecule-sshd
        - ansible-collection-services-molecule-squid
        - ansible-collection-services-molecule-thanos_sidecar
        - ansible-collection-services-molecule-teleport
        - ansible-collection-services-molecule-traefik
        - ansible-collection-services-molecule-tuned
        - ansible-collection-services-molecule-wazuh-agent
        - ansible-collection-services-molecule-wireguard
        - ansible-collection-services-molecule-zabbix_agent
        - ansible-collection-ensure-readme
        - ansible-lint
        - flake8
        - python-black
        - yamllint
    periodic-daily:
      jobs:
        - ansible-lint
        - flake8
        - python-black
        - yamllint
    post:
      jobs:
        - ansible-collection-services-container-image-osism-ansible-push:
            branches: main
