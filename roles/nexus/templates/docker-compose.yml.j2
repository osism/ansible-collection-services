---
version: '3'

services:
  nexus:
    container_name: nexus
    restart: unless-stopped
    image: "{{ nexus_image }}"
    ports:
      - "{{ nexus_host }}:{{ nexus_port }}:8081"
      - "{{ nexus_host }}:{{ nexus_port + 1 }}:{{ nexus_port + 1 }}"
      - "{{ nexus_host }}:{{ nexus_port + 2 }}:{{ nexus_port + 2 }}"
      - "{{ nexus_host }}:{{ nexus_port + 3 }}:{{ nexus_port + 3 }}"
      - "{{ nexus_host }}:{{ nexus_port + 4 }}:{{ nexus_port + 4 }}"
      - "{{ nexus_host }}:{{ nexus_port + 5 }}:{{ nexus_port + 5 }}"
      - "{{ nexus_host }}:{{ nexus_port + 6 }}:{{ nexus_port + 6 }}"
      - "{{ nexus_host }}:{{ nexus_port + 7 }}:{{ nexus_port + 7 }}"
      - "{{ nexus_host }}:{{ nexus_port + 8 }}:{{ nexus_port + 8 }}"
      - "{{ nexus_host }}:{{ nexus_port + 9 }}:{{ nexus_port + 9 }}"
    volumes:
      - "/etc/hosts:/etc/hosts:ro"
    healthcheck:
      test: curl --silent --fail localhost:8081
    volumes:
      - "data:/nexus-data"
      - "{{ nexus_configuration_directory }}/nexus.properties:/nexus-data/etc/nexus.properties:ro"

volumes:
  data:

networks:
 default:
   driver: bridge
   ipam:
     driver: default
     config:
       - subnet: {{ nexus_network }}
