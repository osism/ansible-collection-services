---
- name: Copy private ssh keys
  become: true
  ansible.builtin.template:
    src: config-ssh-key.j2
    dest: "{{ secrets_directory }}/id_rsa.{{ item.key }}"
    owner: "{{ operator_user }}"
    mode: 0600
  loop: "{{ private_keys | dict2items }}"
  no_log: true
  # NOTE: Depending on the time at which the role is executed, certain keys are
  #       not yet present in the correct places. However, this is fine and a warning
  #       is therefore not necessary. So that the warning that a key has not yet
  #       been found is not displayed, warnings are ignored here.
  args:
    warn: false

- name: Copy ansible environment file
  ansible.builtin.template:
    src: env/ansible.env.j2
    dest: "{{ manager_configuration_directory }}/ansible.env"
    mode: 0640
    owner: "{{ operator_user }}"
    group: "{{ operator_group }}"
